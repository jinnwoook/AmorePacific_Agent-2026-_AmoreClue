# 트렌드 분류 시스템 요약

## 📌 핵심 답변

### 1. 집계 기간 설정

**권장: 8주 (56일) Rolling Window**

**이유:**
- ✅ 화장품 제품 인지도 형성: 6-8주
- ✅ 소비자 구매 결정 주기: 4-6주
- ✅ 노이즈 제거: 일일 변동성 ±15-20% → 8주 평균 ±3-5%
- ✅ 리뷰 축적: 6-8주 필요

**구현:**
- 매일 Raw 데이터 수집
- 매주 월요일 트렌드 집계
- 8주 Rolling Window로 트렌드 계산
- 최근 주에 더 높은 가중치 (Week 8: 25%, Week 1: 1%)

---

### 2. 리더보드 안정성 확보

**문제:** 매일 집계하면 순위가 계속 변동

**해결책:**
```javascript
// 5% 이상 변화 시에만 순위 업데이트
const STABILITY_THRESHOLD = 0.05;

// 변화율 계산
const change = Math.abs((newScore - oldScore) / oldScore);

if (change >= STABILITY_THRESHOLD) {
  // 업데이트
} else {
  // 유지
}
```

**추가 전략:**
- 최소 6주 데이터 필요
- 최소 2점 이상 변화
- 급격한 변화 시 롤백 메커니즘

---

### 3. 다요소 트렌드 분류

**7가지 요소 종합 점수:**

| 요소 | 가중치 | 설명 |
|------|--------|------|
| 성장률 | 25% | 전주 대비 증가율 |
| 신호 일관성 | 20% | SNS/Retail/Review 상관관계 |
| 절대 규모 | 15% | 언급 수, 판매량, 리뷰 수 |
| 지속성 | 15% | 연속 상승 주수 |
| 시장 점유율 | 10% | 카테고리 내 점유율 |
| 리뷰 품질 | 10% | 긍정률, 평균 평점 |
| 가속도 | 5% | 변화율의 변화율 |

**분류 기준:**

```javascript
EARLY:     점수 > 0.5, 성장률 > 30%, 규모 작음
GROWING:   점수 > 0.6, 성장률 10-30%, 규모 중간
ACTIONABLE: 점수 > 0.7, 성장률 5-10%, 규모 큼, 일관성 높음
```

---

### 4. AI 알고리즘 활용

**하이브리드 접근:**

1. **규칙 기반 필터링** (빠른 처리)
   - 명확한 케이스는 즉시 분류
   - 예: 성장률 > 50% + 규모 < 1000 → EARLY

2. **ML 모델** (애매한 케이스)
   - Random Forest / XGBoost
   - 12개 특성 벡터 입력
   - 4개 클래스 출력

3. **앙상블** (최종 결정)
   - 규칙 + ML 결과 결합
   - 신뢰도 < 0.7 → 보수적 분류 (GROWING)

**특성 벡터:**
```javascript
[
  growth_rate,           // 성장률
  signal_consistency,    // 신호 일관성
  sns_volume,           // SNS 볼륨
  retail_volume,        // 리테일 볼륨
  review_volume,        // 리뷰 볼륨
  persistence_weeks,    // 지속 주수
  market_share,         // 시장 점유율
  positive_review_rate, // 긍정 리뷰 비율
  avg_rating,          // 평균 평점
  acceleration,         // 가속도
  volatility,          // 변동성
  trend_strength       // 트렌드 강도
]
```

---

## 📊 실무 권장사항

### 집계 주기
- **Raw 데이터**: 매일 수집
- **트렌드 집계**: 매주 월요일
- **리더보드 업데이트**: 매일 집계, 5% 이상 변화 시에만 반영

### 분류 신뢰도
- **ACTIONABLE**: 신뢰도 > 0.7
- **GROWING**: 신뢰도 > 0.6
- **EARLY**: 신뢰도 > 0.5
- **신뢰도 < 0.5**: 재분석 필요

### 데이터 품질
- 최소 6주 데이터 필요
- 최소 3개 신호 타입 (SNS, Retail, Review)
- 이상치 제거 (Z-score > 3)

---

## 🔧 구현 파일

1. **`server/services/trendClassifier.js`**
   - 트렌드 분류 로직
   - 7가지 요소 점수 계산
   - 종합 점수 및 분류

2. **`server/index.js`**
   - API 엔드포인트
   - `/api/trends/classify` - 트렌드 분류
   - `/api/leaderboard/update` - 안정성 고려 업데이트

3. **`docs/trend_analysis_strategy.md`**
   - 상세 전략 문서
   - 마케팅/경제학적 근거
   - AI 모델 설계

---

## 💡 다음 단계

1. **데이터 수집 파이프라인 구축**
   - Raw 데이터 수집 스크립트
   - 전처리 및 정제

2. **ML 모델 학습**
   - 과거 데이터로 학습
   - 교차 검증
   - 하이퍼파라미터 튜닝

3. **모니터링 시스템**
   - 분류 정확도 추적
   - 임계값 조정
   - A/B 테스트

